<!DOCTYPE html>
<!--
 Dashboard Bolsa Docents - Lleida
 Sistema de gestión de nombramientos para docentes
 
 Desarrollado por @CarlesMiranda
 Fecha: Septiembre 2025
-->
<html lang="es" data-color-scheme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="@CarlesMiranda">
    <meta name="description" content="Sistema de gestión de nombramientos para docentes - Bolsa Docents Lleida">
    <title>Dashboard Bolsa Docents - Lleida | @CarlesMiranda</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- Firebase SDK -->
    <script type="module" src="firebase-config.js"></script>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <h1>Dashboard Bolsa Docents</h1>
                <p>Lleida - Sistema de Nombramientos</p>
            </div>
            
            <form id="loginForm" class="login-form">
                <div class="login-form-group">
                    <label for="username" class="login-label">Usuario</label>
                    <input 
                        type="text" 
                        id="username" 
                        class="login-input" 
                        required 
                        autocomplete="username"
                        placeholder="Introduce tu usuario"
                    >
                </div>
                
                <div class="login-form-group">
                    <label for="password" class="login-label">Contraseña</label>
                    <input 
                        type="password" 
                        id="password" 
                        class="login-input" 
                        required 
                        autocomplete="current-password"
                        placeholder="Introduce tu contraseña"
                    >
                </div>
                
                <div id="loginError" class="login-error hidden">
                    Usuario o contraseña incorrectos
                </div>
                
                <button type="submit" class="login-btn" id="loginSubmitBtn">
                    <span class="login-btn-text">Acceder</span>
                    <span class="login-btn-loading hidden">Verificando...</span>
                </button>
            </form>
            
            <div class="login-footer">
                <small>Desarrollado por <strong>@CarlesMiranda</strong></small>
            </div>
        </div>
    </div>

    <!-- Main Dashboard (hidden initially) -->
    <div id="mainDashboard" class="dashboard hidden">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="container">
                <h1>Dashboard Bolsa Docents - Lleida</h1>
                <div class="user-info">
                    <div class="user-order-section">
                        <span class="status status--info">
                            Nº Orden: 
                            <span id="displayOrderNumber" class="order-number-display">101.322</span>
                            <button type="button" id="editOrderBtn" class="edit-order-btn" title="Editar número de orden">
                                ✏️
                            </button>
                        </span>
                        <div id="editOrderForm" class="edit-order-form hidden">
                            <input type="number" id="newOrderNumber" class="order-input" placeholder="Nuevo número de orden">
                            <button type="button" id="saveOrderBtn" class="save-order-btn">✓</button>
                            <button type="button" id="cancelOrderBtn" class="cancel-order-btn">✕</button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <main class="container">
            <!-- Floating Add Button -->
            <button type="button" class="floating-add-btn" id="openFormModalBtn" title="Añadir nuevo nombramiento">
                <span class="plus-icon">+</span>
            </button>

            <!-- Section 1: Specialty Flashcards -->
            <section class="dashboard-section">
                <div class="section-header">
                    <h2>Especialidades</h2>
                    <button type="button" class="btn btn--secondary" id="manageSpecialtiesBtn" title="Gestionar especialidades">
                        ⚙️ Gestionar
                    </button>
                </div>
                <div class="flashcards-grid" id="specialtyCards">
                    <!-- Specialty cards will be generated by JavaScript -->
                </div>
            </section>

            <!-- Section 2: Latest Appointments Table -->
            <section class="dashboard-section">
                <h2>Últimos Nombramientos</h2>
                <div class="card">
                    <div class="table-container">
                        <table class="appointments-table" id="appointmentsTable">
                            <thead>
                                <tr>
                                    <th class="sortable" data-sort="fecha">
                                        Fecha 
                                        <span class="sort-icon">↕</span>
                                    </th>
                                    <th class="sortable" data-sort="especialidad">
                                        Especialidad 
                                        <span class="sort-icon">↕</span>
                                    </th>
                                    <th class="sortable" data-sort="numero">
                                        Nº Orden 
                                        <span class="sort-icon">↕</span>
                                    </th>
                                    <th class="sortable" data-sort="centro">
                                        Centro 
                                        <span class="sort-icon">↕</span>
                                    </th>
                                    <th class="sortable" data-sort="duracion">
                                        Duración 
                                        <span class="sort-icon">↕</span>
                                    </th>
                                    <th class="sortable" data-sort="jornada">
                                        Jornada 
                                        <span class="sort-icon">↕</span>
                                    </th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Table rows will be generated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Section 3: Rhythm Analysis -->
            <section class="dashboard-section">
                <h2>Análisis de Ritmo</h2>
                <div class="rhythm-cards">
                    <div class="card rhythm-card">
                        <div class="card__body">
                            <h3>Ritmo Normal</h3>
                            <div class="rhythm-data" id="normalRhythm">
                                <div class="rhythm-item">
                                    <span class="specialty">TEC</span>
                                    <span class="progression">Progresión constante</span>
                                </div>
                                <div class="rhythm-detail">
                                    <small>Incremento promedio semanal: ~12,579</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card rhythm-card">
                        <div class="card__body">
                            <h3>Saltos Significativos</h3>
                            <div class="rhythm-data" id="significantJumps">
                                <div class="rhythm-item warning">
                                    <span class="specialty">TEC</span>
                                    <span class="jump">+42,963 (28/08 → 08/09)</span>
                                </div>
                                <div class="rhythm-item warning">
                                    <span class="specialty">TEC</span>
                                    <span class="jump">+30,984 (08/09 → 09/09)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 4: Time Estimation -->
            <section class="dashboard-section">
                <h2>Estimación de Tiempo</h2>
                <div class="estimation-cards">
                    <div class="card estimation-card success">
                        <div class="card__body">
                            <h3>TEC - Tecnología</h3>
                            <div class="estimation-main">
                                <div class="time-estimate">
                                    <span class="time-value">0.5</span>
                                    <span class="time-unit">días</span>
                                </div>
                                <div class="estimate-detail">
                                    <small>Restantes: 948 posiciones</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card estimation-card warning">
                        <div class="card__body">
                            <h3>507 - Informática</h3>
                            <div class="estimation-main">
                                <div class="time-estimate">
                                    <span class="time-value">42.4</span>
                                    <span class="time-unit">días</span>
                                </div>
                                <div class="estimate-detail">
                                    <small>Restantes: 76,262 posiciones</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card estimation-card info">
                        <div class="card__body">
                            <h3>623 - Producción Arts Gràfiques</h3>
                            <div class="estimation-main">
                                <div class="time-estimate">
                                    <span class="time-value">N/D</span>
                                    <span class="time-unit">datos insuf.</span>
                                </div>
                                <div class="estimate-detail">
                                    <small>Restantes: 68,167 posiciones</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
        
        <!-- Footer -->
        <footer class="app-footer">
            <div class="container">
                <small>Desarrollado por <strong>@CarlesMiranda</strong> - Septiembre 2025</small>
            </div>
        </footer>
    </div>
    <!-- End Main Dashboard -->

    <!-- Manage Specialties Modal -->
    <div id="manageSpecialtiesModal" class="modal hidden">
        <div class="modal-content manage-specialties-modal">
            <div class="modal-header">
                <h3>Gestionar Especialidades</h3>
                <button type="button" class="modal-close" id="closeSpecialtiesModal">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Add New Specialty Section -->
                <div class="add-specialty-section">
                    <h4>Añadir Nueva Especialidad</h4>
                    <form id="addSpecialtyForm" class="specialty-form">
                        <div class="form-grid specialty-grid">
                            <div class="form-group">
                                <label for="newSpecialtyCode" class="form-label">Código</label>
                                <input type="text" id="newSpecialtyCode" class="form-control" required placeholder="Ej: 720">
                            </div>
                            <div class="form-group">
                                <label for="newSpecialtyName" class="form-label">Nombre</label>
                                <input type="text" id="newSpecialtyName" class="form-control" required placeholder="Ej: Nueva Especialidad">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Estado</label>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="newSpecialtyPending" checked>
                                        <span class="checkbox-text">Pendent p.c.</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn--primary">Añadir Especialidad</button>
                    </form>
                </div>

                <!-- Existing Specialties Section -->
                <div class="existing-specialties-section">
                    <h4>Especialidades Existentes</h4>
                    <div class="specialties-list" id="specialtiesList">
                        <!-- Existing specialties will be generated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Appointment Modal -->
    <div id="addAppointmentModal" class="modal hidden">
        <div class="modal-content form-modal">
            <div class="modal-header">
                <h3>Añadir Nuevo Nombramiento</h3>
                <button type="button" class="modal-close" id="closeFormModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="appointmentForm" class="appointment-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="fecha" class="form-label">Fecha</label>
                            <input type="date" id="fecha" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="especialidad" class="form-label">Especialidad</label>
                            <select id="especialidad" class="form-control" required>
                                <option value="">Seleccionar especialidad...</option>
                                <option value="712">712 - Disseny Gràfic</option>
                                <option value="715">715 - Fotografia</option>
                                <option value="507">507 - Informàtica</option>
                                <option value="721">721 - Mitjans Audiovisuals</option>
                                <option value="722">722 - Mitjans Informàtics</option>
                                <option value="519">519 - Processos I Mitjans De Comunicació</option>
                                <option value="522">522 - Processos I Productes D'Arts Gràfiques</option>
                                <option value="623">623 - Producció En Arts Gràfiques</option>
                                <option value="627">627 - Sistemes I Aplicacions Informàtiques</option>
                                <option value="TEC">TEC - Tecnologia</option>
                                <option value="629">629 - Tècniques I Procediments D'Imatge I So</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="numero" class="form-label">Nº Orden</label>
                            <input type="number" id="numero" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="centro" class="form-label">Centro</label>
                            <input type="text" id="centro" class="form-control" required placeholder="Nombre del centro educativo">
                        </div>
                        
                        <div class="form-group">
                            <label for="duracion" class="form-label">Duración</label>
                            <div class="duration-inputs">
                                <input type="date" id="inicio" class="form-control" required placeholder="Fecha inicio">
                                <span class="duration-separator">-</span>
                                <input type="date" id="fin" class="form-control" required placeholder="Fecha fin">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="jornada" class="form-label">Jornada</label>
                            <select id="jornada" class="form-control" required>
                                <option value="">Seleccionar jornada...</option>
                                <option value="Sencera">Sencera</option>
                                <option value="0,50">0,50</option>
                                <option value="0,25">0,25</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn--primary">
                            Añadir Nombramiento
                        </button>
                        <button type="button" class="btn btn--outline" id="clearFormBtn">
                            Limpiar Formulario
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Success/Error Messages Modal -->
    <div id="messageModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Mensaje</h3>
                <button type="button" class="modal-close" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <p id="modalMessage"></p>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>